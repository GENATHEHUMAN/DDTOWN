<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/components/translation.css">

<div id="google_translate_element" style="display:none;"></div>

    <select  id="translateSelectBar">
    	<option value="ko" class="ko">ğŸ‡°ğŸ‡·</option>
    	<option value="en" class="en">ğŸ‡ºğŸ‡¸</option>
    	<option value="ja" class="ja">ğŸ‡¯ğŸ‡µ</option>
    	<option value="zh-CN" class="zh-CN">ğŸ‡¨ğŸ‡³</option>
    </select>

<script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script type="text/javascript">
    // Google Translate Element ì´ˆê¸°í™” í•¨ìˆ˜
    function googleTranslateElementInit() {
        console.log("googleTranslateElementInit CALLED.");
        new google.translate.TranslateElement(
            {
                pageLanguage: 'ko', // ì›¹ í˜ì´ì§€ì˜ ê¸°ë³¸ ì–¸ì–´
                autoDisplay: false,
                includedLanguages: 'ko,en,ja,zh-CN', // ë²ˆì—­ ì œê³µ ì–¸ì–´
                layout: google.translate.TranslateElement.InlineLayout.SIMPLE
            },
            'google_translate_element'
        );
    }

    // ì¿ í‚¤ ì„¤ì • í•¨ìˆ˜
    function setCookie(name, value, days) {
        let expires = "";
        if (days) {
            let date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            expires = "; expires=" + date.toUTCString();
        }
        // googtrans ì¿ í‚¤ëŠ” path=/ ë¡œ ì„¤ì •ë˜ì–´ì•¼ Google Translateê°€ ì¸ì‹í•©ë‹ˆë‹¤.
        document.cookie = name + "=" + (value || "") + expires + "; path=/";
        console.log("Cookie set: " + name + "=" + value);
    }

    // ì¿ í‚¤ ê°€ì ¸ì˜¤ê¸°
    function getCookie(name) {
        var value = document.cookie.match('(^|;) ?' + name + '=([^;]*)(;|$)');
        return value? value[2] : null;
    }

    // DOM ë¡œë“œ ì™„ë£Œ í›„ ì–¸ì–´ ë³€ê²½ ë§í¬ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
    document.addEventListener('DOMContentLoaded', function() {
    	const translateSelectBar = document.getElementById("translateSelectBar");
    	
    	translateSelectBar.addEventListener("change",function(e){
    		const targetLang = this.value;
            const sourceLang = 'ko';
    		setCookie('googtrans', '/' + sourceLang + '/' + targetLang, 1); // ì¿ í‚¤ ìœ íš¨ê¸°ê°„ 1ì¼
            window.location.reload();
    	})
    	
    	let value = getCookie("googtrans");
    	if(value == "/ko/en"){
    		translateSelectBar.value = "en"
    	}else if(value == "/ko/ja"){
    		translateSelectBar.value = "ja"
    	}else if(value == "/ko/zh-CN"){
    		translateSelectBar.value = "zh-CN"
    	}
    });
</script>