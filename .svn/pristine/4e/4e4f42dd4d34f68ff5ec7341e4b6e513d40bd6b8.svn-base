package kr.or.ddit.ddtown.service.concert;

import java.util.List;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import kr.or.ddit.ServiceResult;
import kr.or.ddit.ddtown.mapper.concert.IConcertMapper;
import kr.or.ddit.vo.PaginationInfoVO;
import kr.or.ddit.vo.concert.ConcertVO;
import lombok.extern.slf4j.Slf4j;

@Slf4j
@Service
public class ConcertServiceImpl implements ConcertService { 

    @Autowired
    private IConcertMapper concertMapper; 

    @Override
    public List<ConcertVO> selectConcertList(PaginationInfoVO<ConcertVO> pagingVO) throws Exception {
        log.info("selectConcertList() 실행...!");
        return concertMapper.selectConcertList(pagingVO);
    }

    @Override
    public int selectConcertCount(PaginationInfoVO<ConcertVO> pagingVO) throws Exception {
    	log.info("selectConcertCount() 실행...!");
        return concertMapper.selectConcertCount(pagingVO);
    }

    @Override
    public ConcertVO selectSchedule(int concertNo) throws Exception {
    	log.info("selectSchedule() 실행...!");
        return concertMapper.selectSchedule(concertNo);
    }

    @Transactional
    @Override
    public ServiceResult insertSchedule(ConcertVO concertVO) throws Exception {
    	log.info("insertSchedule() 실행...!");
    	
        int row = concertMapper.insertSchedule(concertVO);
        log.info("insertSchedule() 실행 후 concertNo : " + concertVO.getConcertNo());
        log.info("concertVO : " + concertVO);
        if (row > 0) {
            log.info("콘서트 일정 등록 성공: {}", concertVO.getConcertNm());
            return ServiceResult.OK;
        }
        log.warn("콘서트 일정 등록 실패: {}", concertVO.getConcertNm());
        return ServiceResult.FAILED;
    }

    @Transactional
    @Override
    public ServiceResult updateSchedule(ConcertVO concertVO) throws Exception {
    	log.info("updateSchedule() 실행...!");
    	
        int row = concertMapper.updateSchedule(concertVO);
        if (row > 0) {
	        log.info("콘서트 일정 수정 성공 (번호: {})", concertVO.getConcertNo());
	        return ServiceResult.OK;
        }
        log.warn("콘서트 일정 수정 실패 (번호: {}): {}", concertVO.getConcertNo());
        return ServiceResult.FAILED;
    }

    @Transactional
    @Override
    public ServiceResult deleteSchedule(int concertNo) throws Exception {
    	log.info("deleteSchedule() 실행...!");
        
        int row = concertMapper.deleteSchedule(concertNo);
        if (row > 0) {
            log.info("콘서트 일정 삭제 성공 (번호: {})", concertNo);
            return ServiceResult.OK;
        }
        log.warn("콘서트 일정 삭제 실패 (번호: {})", concertNo);
        return ServiceResult.FAILED;
    }
}