<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
    <%-- CSS 파일 경로 수정: ${pageContext.request.contextPath}/resources 를 기준으로 설정 --%>
<link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/pages/admin_portal.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script type="text/javascript" src="${pageContext.request.contextPath}/resources/ckeditorInquiry/ckeditor.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/admin-lte@3.1/dist/js/adminlte.min.js"></script>

<!-- 아코디언 시작 -->
<link rel="stylesheet" href="/resources/dist/css/adminlte.min.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" >
<script src="/resources/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- 아코디언 끝 -->

<style type="text/css">

.modal-detail-title{
 	display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    background-color: #ffffff;
}
.modal-detail-title .faq-info { display: flex; align-items: center; flex-grow: 1; }

.modal-detail-title .faq-category {
    font-size: 0.85em;
    color: #fff;
    background-color: #5dade2;
    padding: 4px 8px;
    border-radius: 4px;
    font-weight: 500;
    margin-right: 12px;
    flex-shrink: 0;
}

.modal-detail-title .faq-question-text {
    font-weight: 500;
    color: #2c3e50;
    flex-grow: 1;
}

.mb-3 .form-control {
	height : 300px;
    resize: none;
}

.mb-3 .form-control:disabled {
	background-color : #ffffff;
}
</style>
</head>

<script type="text/javascript">

function dateFormat(jsonDate){
	if (!jsonDate) return "";
	let date = new Date(jsonDate);
	let month = date.getMonth() + 1;
    let day = date.getDate();
    let hour = date.getHours();
    let minute = date.getMinutes();
    let second = date.getSeconds();

    month = month >= 10 ? month : '0' + month;
    day = day >= 10 ? day : '0' + day;
    hour = hour >= 10 ? hour : '0' + hour;
    minute = minute >= 10 ? minute : '0' + minute;
    second = second >= 10 ? second : '0' + second;

    return date.getFullYear() + '-' + month + '-' + day;
}

$(function(){
	
	$.ajax({
		url : "/admin/faq/list",
		type : "get",
		success : function(res){
			console.log(res);
			let html = ``;
			if(res != null && res.length > 0){
				for(let i=0; i<res.length; i++){
					let vo = res[i];
					html += `
	                    <div class="card card-primary card-outline">
		                    <a class="d-block w-100 faq-item" data-faq-id="\${vo.faqNo}" data-toggle="collapse" href="#collapse\${i}" aria-expanded="true">
		                        <div class="card-header faq-question-header">
		                            <h4 class="card-title w-100 faq-info">
		                            	<span class="faq-category">\${vo.description}</span> <span class="faq-question-text">Q. \${vo.faqTitle}</span>
		                            </h4>
		                        </div>
		                    </a>
                            <div class="faq-actions">
                            	<button class="ea-btn sm outline" data-toggle="modal" data-target="#modal-lg" data-faqNo="\${vo.faqNo}" name="detailBtn" id="detailBtn"><i class="fas fa-edit"></i></button>
                                <button class="ea-btn sm danger" title="삭제" onclick="deleteFaqItem(101, this)"><i class="fas fa-trash-alt"></i></button>
                            </div>
		                    <div id="collapse\${i}" class="collapse" data-parent="#accordion" style="">
		                        <div class="card-body">
		                        	A. \${vo.faqAnswer}
		                        </div>
		                    </div>
		                </div>
					`;
					
				}
			}
			
			$("#accordion").html(html);
		},
		error : function(error, status, thrown){
			console.log(error.status);
		}
	});
	
	$(document).on("click","#detailBtn",function(event){
		console.log("123",this.dataset.faqno);
		let faqNo = this.dataset.faqno;
		$.ajax({
			url : "/admin/faq/detailData/" + faqNo, 
			type : "get",
			success : function(res){
				console.log(res);
				$("#faqCategory").html(res.description);
				$("#faqTitle").html(res.faqTitle);
				$("#faqAnswer").html(res.faqAnswer);
				$("#empUsername").html(res.empUsername);
				$("#faqModDate").html(dateFormat(res.faqModDate));
			},
			error : function(error, status, thrown){
				console.log(error.status);
			}
		});
	});
	
	$("#updateForm").on("click")
	
});


</script>
<body>
<!-- 
<div class="faq-item" data-faq-id="\${vo.faqNo}">
	<div class="accordion-button">
		<span class="faq-category">\${vo.description}</span>
                       <span class="faq-question-text">\${vo.faqTitle}</span>
	</div>
	<div class="faq-actions">
		<a href="admin_cs_faq_form.html?id=101&mode=edit" class="ea-btn sm outline" title="수정"><i class="fas fa-edit"></i></a>
                    <button class="ea-btn sm danger" title="삭제" onclick="deleteFaqItem(101, this)"><i class="fas fa-trash-alt"></i></button>
                    <span class="toggle-arrow">&gt;</span>
                </div>
</div>
<div class="faq-answer-content">
    <p>\${vo.faqContent}</p>
</div>
-->
faqMain
<main class="emp-content">
	<section id="csFaqListSection" class="ea-section active-section">
		<div class="ea-section-header">
			<h2>FAQ 관리</h2>
			<div class="ea-header-actions">
				<input type="text" class="ea-search-input" id="faqSearchInput" placeholder="질문, 답변 내용 검색...">
				<select id="faqCategoryFilter" class="ea-filter-select">
				</select>
				<button class="ea-btn primary" onclick="location.href='admin_cs_faq_form.html'">
                    <i class="fas fa-plus"></i> 새 FAQ 등록
                </button>
			</div>
		</div>
		
		<div class="faq-list-container" id="accordion">
			
		</div>
	</section>
</main>

<div class="modal fade" id="modal-lg" style="display: none;" aria-hidden="true">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			 <div class="modal-header">
			 	<div class="modal-title">
			 		<div class="modal-detail-title">
				 		<h4 class="card-title w-100 faq-info">
					 		<span class="faq-category" id="faqCategory"></span>
							<span class="faq-question-text" id="faqTitle"></span>
				 		</h4>
			 		</div>
			 		<div class="answer-history">
				 		<div class="answer-meta">
	        				<span id="empUsername"></span> | <span id="faqModDate"></span>
	        			</div>
			 		</div>
			 	</div>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
				  <span aria-hidden="true">×</span>
				</button>
			 </div>
			 <div class="modal-body">
				<form>
					<div class="mb-3">
						<label for="faqAnswer" class="col-form-label">내용</label>
						<textarea class="form-control" id="faqAnswer" disabled="disabled"></textarea>
					</div>
				</form>
			 </div>
			 <div class="modal-footer justify-content-between">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-warning" id="updateForm">수정</button>
			 </div>
		</div>
	  <!-- /.modal-content -->
	</div>
	<!-- /.modal-dialog -->
</div>
</body>
</html>