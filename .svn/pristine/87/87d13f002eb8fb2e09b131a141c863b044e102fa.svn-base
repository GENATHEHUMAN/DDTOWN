<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="kr.or.ddit.ddtown.mapper.emp.artist.ArtistGroupMapper">
 
 	<resultMap type="kr.or.ddit.vo.artist.ArtistGroupVO" id="artistGroup">
 		<result property="artGroupRegDate" column="ART_GROUP_REG_DATE"/>
		<result property="artGroupDelYn" column="ART_GROUP_DEL_YN"/>
		<result property="artGroupProfileImg" column="ART_GROUP_PROFILE_IMG"/>
		<result property="artGroupModDate" column="ART_GROUP_MOD_DATE"/>
		<result property="artGroupNo" column="ART_GROUP_NO"/>
		<result property="artGroupTypeCode" column="ART_GROUP_TYPE_CODE"/>
		<result property="empUsername" column="EMP_USERNAME"/>
		<result property="artGroupDebutdate" column="ART_GROUP_DEBUTDATE"/>
		<result property="artGroupNm" column="ART_GROUP_NM"/>
		<result property="artGroupContent" column="ART_GROUP_CONTENT"/>
		
		<collection property="artistVOs" resultMap="artist"></collection>
 	</resultMap>
 	
 	<resultMap type="kr.or.ddit.vo.artist.ArtistVO" id="artist">
 		<result property="artNo" column="ART_NO"/>
		<result property="artGroupNo" column="ART_GROUP_NO"/>
		<result property="memUsername" column="MEM_USERNAME"/>
		<result property="artNm" column="ART_NM"/>
		<result property="artContent" column="ART_CONTENT"/>
		<result property="artRegDate" column="ART_REG_DATE"/>
		<result property="artModDate" column="ART_MOD_DATE"/>
		<result property="artProfileImg" column="ART_PROFILE_IMG"/>
 	</resultMap>
 
 	<select id="retrieveArtistGroupList" resultMap="artistGroup">
 		SELECT
		    A.ART_GROUP_NO
		  , A.ART_GROUP_TYPE_CODE
		  , A.EMP_USERNAME
		  , A.ART_GROUP_DEBUTDATE
		  , A.ART_GROUP_NM
		  , A.ART_GROUP_CONTENT
		  , A.ART_GROUP_REG_DATE
		  , A.ART_GROUP_DEL_YN
		  , A.ART_GROUP_PROFILE_IMG
		  , A.ART_GROUP_MOD_DATE
		  , B.ART_NO
		  , B.MEM_USERNAME
		  , B.ART_NM
		  , B.ART_CONTENT
		  , B.ART_REG_DATE
		  , B.ART_MOD_DATE
		  , B.ART_PROFILE_IMG
		FROM
		    ARTIST_GROUP A
		  , ARTIST       B
		WHERE
		        A.ART_GROUP_DEL_YN = 'N'
		    AND A.ART_GROUP_NO = B.ART_GROUP_NO
		ORDER BY
		    A.ART_GROUP_NO DESC
 	</select>
 	
 	<update id="updateArtistGroup" parameterType="kr.or.ddit.vo.artist.ArtistGroupVO">
 		UPDATE ARTIST_GROUP
		SET
		    ART_GROUP_NM = #{artGroupNm}
		    , ART_GROUP_TYPE_CODE = #{artGroupTypeCode}
		    , ART_GROUP_DEBUTDATE = #{artGroupDebutdate}
		    , ART_GROUP_CONTENT = #{artGroupContent}
		    , ART_GROUP_PROFILE_IMG = #{artGroupProfileImg}
		    , ART_GROUP_MOD_DATE = SYSDATE
		WHERE
		    ART_GROUP_NO = #{artGroupNo}
 	</update>
 	
 	<update id="unassignArtistsFromGroup" parameterType="int">
 		UPDATE ARTIST
 		SET
 			ART_GROUP_NO = NULL
 		WHERE 
 			ART_GROUP_NO = #{artGroupNoValue}
 	</update>
 	
 	<update id="assignArtistsToGroup"> 
 		UPDATE ARTIST
	    SET
	        ART_GROUP_NO = #{artGroupNo} 
	    WHERE
	        ART_NO IN
	        <foreach collection="artistIds" item="artId" open="(" separator="," close=")"> 
	        	#{artId}
	        </foreach>
	</update>
 	
 </mapper>
 
 
 
 
 