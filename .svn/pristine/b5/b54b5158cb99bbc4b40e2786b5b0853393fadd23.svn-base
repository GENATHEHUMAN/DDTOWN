<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="kr.or.ddit.ddtown.mapper.community.ICommunityMainPageMapper">
 
	<resultMap type="kr.or.ddit.vo.artist.ArtistGroupVO" id="artistGroup">
		<id property="artGroupNo" column="ART_GROUP_NO"/>
		<result property="artGroupRegDate" column="ART_GROUP_REG_DATE"/>
		<result property="artGroupDelYn" column="ART_GROUP_DEL_YN"/>
		<result property="artGroupProfileImg" column="ART_GROUP_PROFILE_IMG"/>
		<result property="artGroupModDate" column="ART_GROUP_MOD_DATE"/>
		<result property="artGroupTypeCode" column="ART_GROUP_TYPE_CODE"/>
		<result property="empUsername" column="EMP_USERNAME"/>
		<result property="artGroupDebutdate" column="ART_GROUP_DEBUTDATE"/>
		<result property="artGroupNm" column="ART_GROUP_NM"/>
		<result property="artGroupContent" column="ART_GROUP_CONTENT"/>
		
		<collection property="artistList" resultMap="artist"></collection>
	</resultMap> 
	 
	 <resultMap type="kr.or.ddit.vo.artist.ArtistVO" id="artist">
 		<id property="artNo" column="ART_NO"/>
		<result property="memUsername" column="MEM_USERNAME"/>
		<result property="artNm" column="ART_NM"/>
		<result property="artContent" column="ART_CONTENT"/>
		<result property="artRegDate" column="ART_REG_DATE"/>
		<result property="artModDate" column="ART_MOD_DATE"/>
		<result property="artProfileImg" column="ART_PROFILE_IMG"/>
		<result property="artDebutdate" column="ART_DEBUTDATE"/>
		<result property="artDelYn" column="ART_DEL_YN"/>
 	</resultMap>
 	
 	<resultMap type="kr.or.ddit.vo.artist.AlbumVO" id="album">
 		<id property="albumNo" column="ALBUM_NO"/>
		<result property="artGroupNo" column="ART_GROUP_NO"/>
		<result property="albumImg" column="ALBUM_IMG"/>
		<result property="albumNm" column="ALBUM_NM"/>
		<result property="albumDetail" column="ALBUM_DETAIL"/>
		<result property="albumRegDate" column="ALBUM_REG_DATE"/>
		
		<collection property="albumSongs" resultMap="songs"></collection>
 	</resultMap>
	 
	 <resultMap type="kr.or.ddit.vo.artist.AlbumSongVO" id="songs">
	 	<id property="songNo" column="SONG_NO"/>
		<result property="albumNo" column="ALBUM_NO"/>
		<result property="songNm" column="SONG_NM"/>
		<result property="songTitleYn" column="SONG_TITLE_YN"/>
	 </resultMap>
	 
 	<select id="getGroupLists" resultType="kr.or.ddit.vo.artist.ArtistGroupVO">
 		SELECT
		    ART_GROUP_NO
		  , ART_GROUP_NM
		  , ART_GROUP_CONTENT
		  , ART_GROUP_DEBUTDATE
		  , ART_GROUP_PROFILE_IMG
		  , ART_GROUP_DEL_YN
		FROM
		    ARTIST_GROUP
		WHERE
			ART_GROUP_DEL_YN = 'N'
		ORDER BY
			ART_GROUP_NO DESC
 	</select>
 	
 	<select id="getGroupInfo" parameterType="int" resultMap="artistGroup">
 		SELECT
		  	AG.ART_GROUP_NO
		  , AG.ART_GROUP_TYPE_CODE
		  , AG.EMP_USERNAME
		  , AG.ART_GROUP_DEBUTDATE
		  , AG.ART_GROUP_NM
		  , AG.ART_GROUP_CONTENT
		  , AG.ART_GROUP_REG_DATE
		  , AG.ART_GROUP_DEL_YN
		  , AG.ART_GROUP_PROFILE_IMG
		  , AG.ART_GROUP_MOD_DATE
		  
		  , AT.ART_NO
		  , AT.MEM_USERNAME
		  , AT.ART_NM
		  , AT.ART_CONTENT
		  , AT.ART_REG_DATE
		  , AT.ART_MOD_DATE
		  , AT.ART_PROFILE_IMG
		  , AT.ART_DEBUTDATE
		  , AT.ART_DEL_YN
		  
		  , AGM.ART_GROUP_MAP_DEBUTDATE
		  , AGM.ART_DEL_YN
		FROM
		    ARTIST_GROUP AG
		LEFT JOIN 
		    ARTIST_GROUP_MAP AGM ON AG.ART_GROUP_NO = AGM.ART_GROUP_NO 
		LEFT JOIN
		    ARTIST AT ON AGM.ART_NO = AT.ART_NO
		WHERE
		    AG.ART_GROUP_NO = #{artGroupNo}
		AND AG.ART_GROUP_DEL_YN = 'N'
		ORDER BY
				AG.ART_GROUP_NO DESC
 	</select>
 	
 	<select id="getGroupAlbum" parameterType="int" resultMap="album">
 		SELECT
		  A.ALBUM_NO
		  , A.ART_GROUP_NO
		  , A.ALBUM_IMG
		  , A.ALBUM_NM
		  , A.ALBUM_DETAIL
		  , A.ALBUM_REG_DATE
		  
		  , B.SONG_NO
		  , B.ALBUM_NO
		  , B.SONG_NM
		  , B.SONG_TITLE_YN
		FROM
		    ARTIST_ALBUM A
		LEFT JOIN
		    ALBUM_SONG B ON A.ALBUM_NO = B.ALBUM_NO
		WHERE
		    A.ART_GROUP_NO = #{artGroupNo}
		ORDER BY
			A.ALBUM_REG_DATE DESC         
 	</select>
 	
 </mapper>