<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DDTOWN 관리자 - 아티스트 계정 관리</title>
    <%@ include file="../../modules/headerPart.jsp" %>
    <style>
        /* admin_portal.css에 정의된 스타일을 최대한 활용합니다. */
        /* 아티스트명 링크 스타일 */
        .artist-name-link {
            font-weight: 500;
            color: #007bff; /* 기본 링크 색상 */
            text-decoration: none;
        }
        .artist-name-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="emp-container">
        <%@ include file="../modules/header.jsp" %>

        <div class="emp-body-wrapper">
            <%@ include file="../modules/aside.jsp" %>

            <main class="emp-content">
                <section class="ea-section">
                    <div class="ea-section-header">
                        <h2>아티스트 계정 관리</h2>
                        <div class="ea-header-actions">
                        	<form class="input-group input-group-sm" method="get" id="searchForm">
                        		<input type="hidden" name="currentPage" value="1" id="page">
	                            <input type="text" id="searchWord" name="searchWord" value="${pagingVO.searchWord }" class="ea-search-input" placeholder="아티스트명, 그룹명 검색">
	                            <div class="input-group-append">
									<button type="submit" class="btn btn-secondary">
										<i class="fas fa-search"></i>검색
									</button>
								</div>
                        	</form>
                            <a class="ea-btn primary" href="/admin/community/artist/form"><i class="fas fa-plus"></i> 새 아티스트 등록</a>
                        </div>
                    </div>

                    <table class="ea-table" id="artistAccountTable">
                        <thead>
                            <tr>
                                <th>번호</th>
                                <th>아티스트ID(내부용)</th>
                                <th>아티스트명</th>
                                <th>그룹명</th>
                                <th>담당자</th>
                                <th>데뷔일</th>
                                <th>관리</th>
                            </tr>
                        </thead>
                        <tbody id="artistAccountTableBody">
                        	<c:forEach items="${pagingVO.dataList }" var="artist">
                        		<tr>
	                        		<td>${artist.artNo }</td>
	                                <td>${artist.memUsername }</td>
	                                <td>${artist.artNm }</td>
	                                <td>${artist.artGroupNm }</td>
	                                <td>${artist.empUsername }</td>
	                                <td>${artist.artGroupDebutdate }</td>
	                                <td><a class="btn-sm ea-btn" href="/admin/community/artist/detail?artNo=${artist.artNo }">관리</a></td>
	                            </tr>
                        	</c:forEach>
                        </tbody>
                    </table>
                    <div class="ea-pagination" id="paginationControls">
                    	${pagingVO.pagingHTML }
                    </div>
                </section>
            </main>
        </div>

        <footer class="emp-footer">
            <p>&copy; 2025 DDTOWN Entertainment. All rights reserved. (관리자 전용)</p>
        </footer>
    </div>
</body>
<%@ include file="../../modules/footerPart.jsp" %>
<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function() {
	const navItemsWithSubmenu = document.querySelectorAll('.emp-sidebar .emp-nav-item.has-submenu');
	navItemsWithSubmenu.forEach(item => {
		const arrow = item.querySelector('.submenu-arrow');
		item.addEventListener('click', function(event) {
			if (this.getAttribute('href') === '#') {
			    event.preventDefault();
			}
			const parentLi = this.parentElement;
			const submenu = this.nextElementSibling;
		
			if (submenu && submenu.classList.contains('emp-submenu')) {
				const parentUl = parentLi.parentElement;
				if (parentUl) {
					Array.from(parentUl.children).forEach(siblingLi => {
						if (siblingLi !== parentLi) {
							const siblingSubmenuControl = siblingLi.querySelector('.emp-nav-item.has-submenu.open');
							if (siblingSubmenuControl) {
								const siblingSubmenu = siblingSubmenuControl.nextElementSibling;
								siblingSubmenuControl.classList.remove('open');
								if (siblingSubmenu && siblingSubmenu.classList.contains('emp-submenu')) {
								    siblingSubmenu.style.display = 'none';
								}
								const siblingArrow = siblingSubmenuControl.querySelector('.submenu-arrow');
								if (siblingArrow) siblingArrow.style.transform = 'rotate(0deg)';
							}
						}
					});
				}
			}
		
			this.classList.toggle('open');
			if (submenu && submenu.classList.contains('emp-submenu')) {
				submenu.style.display = this.classList.contains('open') ? 'block' : 'none';
				if (arrow) arrow.style.transform = this.classList.contains('open') ? 'rotate(90deg)' : 'rotate(0deg)';
			}
		});
	});
	
	// 페이지네이션 처리 시작
	const searchForm = document.getElementById("searchForm");
	const pageEl = searchForm.querySelector("#page");
	const paginationControls = document.getElementById("paginationControls");
	
	paginationControls.addEventListener("click",function(e){
		e.preventDefault();
		if(e.target.classList.contains("page-link") && e.target.nodeName == "A"){
			pageEl.value = e.target.dataset.page;
			searchForm.submit();			
		}
	})
	// 페이지네이션 처리 끝
	
});
</script>
</html>